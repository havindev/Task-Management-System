{"ast":null,"code":"import _objectSpread from\"/Users/havin/Desktop/Learning/Lap Trinh/ReactJs/task-manager/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import LoadingSpinner from'../Common/LoadingSpinner';import ErrorMessage from'../Common/ErrorMessage';import{validateLoginPayload,validateField,getFirstErrorKey}from'../../utils/validation';import'../../style/LoginForm.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginForm(_ref){let{onLogin,isLoading=false}=_ref;const[formData,setFormData]=useState({username:'',password:''});const[errors,setErrors]=useState({});const[submitError,setSubmitError]=useState('');const usernameRef=useRef(null);const passwordRef=useRef(null);useEffect(()=>{var _usernameRef$current;(_usernameRef$current=usernameRef.current)===null||_usernameRef$current===void 0?void 0:_usernameRef$current.focus();},[]);const focusField=name=>{var _usernameRef$current2,_passwordRef$current;if(name==='username')(_usernameRef$current2=usernameRef.current)===null||_usernameRef$current2===void 0?void 0:_usernameRef$current2.focus();if(name==='password')(_passwordRef$current=passwordRef.current)===null||_passwordRef$current===void 0?void 0:_passwordRef$current.focus();};const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));if(errors[name])setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:''}));if(submitError)setSubmitError('');};const handleBlur=e=>{const{name,value}=e.target;const msg=validateField(name,value);if(msg)setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:msg}));};const handleSubmit=async e=>{e.preventDefault();const{isValid,errors:allErrors,data}=validateLoginPayload(formData);if(!isValid){setErrors(allErrors);const first=getFirstErrorKey(allErrors);if(first)focusField(first);return;}try{await onLogin(data);}catch(error){var _usernameRef$current3;// TODO: Better error message handling\nsetSubmitError(error.message||'Đăng nhập thất bại. Vui lòng thử lại.');(_usernameRef$current3=usernameRef.current)===null||_usernameRef$current3===void 0?void 0:_usernameRef$current3.focus();}};return/*#__PURE__*/_jsx(\"div\",{className:\"login-form-container\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"login-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"login-title\",children:\"\\u0110\\u0103ng nh\\u1EADp\"}),submitError&&/*#__PURE__*/_jsx(ErrorMessage,{message:submitError,onRetry:()=>setSubmitError(''),onDismiss:()=>setSubmitError('')}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",className:\"form-label\",children:\"Username *\"}),/*#__PURE__*/_jsx(\"input\",{ref:usernameRef,type:\"text\",id:\"username\",name:\"username\",value:formData.username,onChange:handleInputChange,onBlur:handleBlur,className:\"form-input \".concat(errors.username?'form-input--error':''),placeholder:\"Nh\\u1EADp username c\\u1EE7a b\\u1EA1n\",disabled:isLoading}),errors.username&&/*#__PURE__*/_jsx(\"span\",{className:\"form-error\",children:errors.username})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-field\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"form-label\",children:\"Password *\"}),/*#__PURE__*/_jsx(\"input\",{ref:passwordRef,type:\"password\",id:\"password\",name:\"password\",value:formData.password,onChange:handleInputChange,onBlur:handleBlur,className:\"form-input \".concat(errors.password?'form-input--error':''),placeholder:\"Nh\\u1EADp password c\\u1EE7a b\\u1EA1n\",disabled:isLoading}),errors.password&&/*#__PURE__*/_jsx(\"span\",{className:\"form-error\",children:errors.password})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",disabled:isLoading,children:isLoading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LoadingSpinner,{size:\"small\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0110ang \\u0111\\u0103ng nh\\u1EADp...\"})]}):'Đăng nhập'})]})});}","map":{"version":3,"names":["React","useState","useRef","useEffect","LoadingSpinner","ErrorMessage","validateLoginPayload","validateField","getFirstErrorKey","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginForm","_ref","onLogin","isLoading","formData","setFormData","username","password","errors","setErrors","submitError","setSubmitError","usernameRef","passwordRef","_usernameRef$current","current","focus","focusField","name","_usernameRef$current2","_passwordRef$current","handleInputChange","e","value","target","prev","_objectSpread","handleBlur","msg","handleSubmit","preventDefault","isValid","allErrors","data","first","error","_usernameRef$current3","message","className","children","onSubmit","onRetry","onDismiss","htmlFor","ref","type","id","onChange","onBlur","concat","placeholder","disabled","size"],"sources":["/Users/havin/Desktop/Learning/Lap Trinh/ReactJs/task-manager/frontend/src/components/Auth/LoginForm.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport LoadingSpinner from '../Common/LoadingSpinner';\nimport ErrorMessage from '../Common/ErrorMessage';\nimport {\n  validateLoginPayload,\n  validateField,\n  getFirstErrorKey,\n} from '../../utils/validation';\nimport '../../style/LoginForm.css';\n\nexport default function LoginForm({ onLogin, isLoading = false }) {\n  const [formData, setFormData] = useState({ username: '', password: '' });\n  const [errors, setErrors] = useState({});\n  const [submitError, setSubmitError] = useState('');\n\n  const usernameRef = useRef(null);\n  const passwordRef = useRef(null);\n\n  useEffect(() => {\n    usernameRef.current?.focus();\n  }, []);\n\n  const focusField = name => {\n    if (name === 'username') usernameRef.current?.focus();\n    if (name === 'password') passwordRef.current?.focus();\n  };\n\n  const handleInputChange = e => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    if (errors[name]) setErrors(prev => ({ ...prev, [name]: '' }));\n    if (submitError) setSubmitError('');\n  };\n\n  const handleBlur = e => {\n    const { name, value } = e.target;\n    const msg = validateField(name, value);\n    if (msg) setErrors(prev => ({ ...prev, [name]: msg }));\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const { isValid, errors: allErrors, data } = validateLoginPayload(formData);\n    if (!isValid) {\n      setErrors(allErrors);\n      const first = getFirstErrorKey(allErrors);\n      if (first) focusField(first);\n      return;\n    }\n\n    try {\n      await onLogin(data);\n    } catch (error) {\n      // TODO: Better error message handling\n      setSubmitError(error.message || 'Đăng nhập thất bại. Vui lòng thử lại.');\n      usernameRef.current?.focus();\n    }\n  };\n\n  return (\n    <div className=\"login-form-container\">\n      <form className=\"login-form\" onSubmit={handleSubmit}>\n        <h2 className=\"login-title\">Đăng nhập</h2>\n\n        {submitError && (\n          <ErrorMessage\n            message={submitError}\n            onRetry={() => setSubmitError('')}\n            onDismiss={() => setSubmitError('')}\n          />\n        )}\n\n        <div className=\"form-field\">\n          <label htmlFor=\"username\" className=\"form-label\">\n            Username *\n          </label>\n          <input\n            ref={usernameRef}\n            type=\"text\"\n            id=\"username\"\n            name=\"username\"\n            value={formData.username}\n            onChange={handleInputChange}\n            onBlur={handleBlur}\n            className={`form-input ${\n              errors.username ? 'form-input--error' : ''\n            }`}\n            placeholder=\"Nhập username của bạn\"\n            disabled={isLoading}\n          />\n          {errors.username && (\n            <span className=\"form-error\">{errors.username}</span>\n          )}\n        </div>\n\n        <div className=\"form-field\">\n          <label htmlFor=\"password\" className=\"form-label\">\n            Password *\n          </label>\n          <input\n            ref={passwordRef}\n            type=\"password\"\n            id=\"password\"\n            name=\"password\"\n            value={formData.password}\n            onChange={handleInputChange}\n            onBlur={handleBlur}\n            className={`form-input ${\n              errors.password ? 'form-input--error' : ''\n            }`}\n            placeholder=\"Nhập password của bạn\"\n            disabled={isLoading}\n          />\n          {errors.password && (\n            <span className=\"form-error\">{errors.password}</span>\n          )}\n        </div>\n\n        <button type=\"submit\" className=\"submit-btn\" disabled={isLoading}>\n          {isLoading ? (\n            <>\n              <LoadingSpinner size=\"small\" />\n              <span>Đang đăng nhập...</span>\n            </>\n          ) : (\n            'Đăng nhập'\n          )}\n        </button>\n      </form>\n    </div>\n  );\n}\n"],"mappings":"0JAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,MAAM,CAAEC,SAAS,KAAQ,OAAO,CAC1D,MAAO,CAAAC,cAAc,KAAM,0BAA0B,CACrD,MAAO,CAAAC,YAAY,KAAM,wBAAwB,CACjD,OACEC,oBAAoB,CACpBC,aAAa,CACbC,gBAAgB,KACX,wBAAwB,CAC/B,MAAO,2BAA2B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEnC,cAAe,SAAS,CAAAC,SAASA,CAAAC,IAAA,CAAiC,IAAhC,CAAEC,OAAO,CAAEC,SAAS,CAAG,KAAM,CAAC,CAAAF,IAAA,CAC9D,KAAM,CAACG,QAAQ,CAAEC,WAAW,CAAC,CAAGnB,QAAQ,CAAC,CAAEoB,QAAQ,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAG,CAAC,CAAC,CACxE,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGvB,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxC,KAAM,CAACwB,WAAW,CAAEC,cAAc,CAAC,CAAGzB,QAAQ,CAAC,EAAE,CAAC,CAElD,KAAM,CAAA0B,WAAW,CAAGzB,MAAM,CAAC,IAAI,CAAC,CAChC,KAAM,CAAA0B,WAAW,CAAG1B,MAAM,CAAC,IAAI,CAAC,CAEhCC,SAAS,CAAC,IAAM,KAAA0B,oBAAA,CACd,CAAAA,oBAAA,CAAAF,WAAW,CAACG,OAAO,UAAAD,oBAAA,iBAAnBA,oBAAA,CAAqBE,KAAK,CAAC,CAAC,CAC9B,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,UAAU,CAAGC,IAAI,EAAI,KAAAC,qBAAA,CAAAC,oBAAA,CACzB,GAAIF,IAAI,GAAK,UAAU,CAAE,CAAAC,qBAAA,CAAAP,WAAW,CAACG,OAAO,UAAAI,qBAAA,iBAAnBA,qBAAA,CAAqBH,KAAK,CAAC,CAAC,CACrD,GAAIE,IAAI,GAAK,UAAU,CAAE,CAAAE,oBAAA,CAAAP,WAAW,CAACE,OAAO,UAAAK,oBAAA,iBAAnBA,oBAAA,CAAqBJ,KAAK,CAAC,CAAC,CACvD,CAAC,CAED,KAAM,CAAAK,iBAAiB,CAAGC,CAAC,EAAI,CAC7B,KAAM,CAAEJ,IAAI,CAAEK,KAAM,CAAC,CAAGD,CAAC,CAACE,MAAM,CAChCnB,WAAW,CAACoB,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,MAAE,CAACP,IAAI,EAAGK,KAAK,EAAG,CAAC,CACjD,GAAIf,MAAM,CAACU,IAAI,CAAC,CAAET,SAAS,CAACgB,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,MAAE,CAACP,IAAI,EAAG,EAAE,EAAG,CAAC,CAC9D,GAAIR,WAAW,CAAEC,cAAc,CAAC,EAAE,CAAC,CACrC,CAAC,CAED,KAAM,CAAAgB,UAAU,CAAGL,CAAC,EAAI,CACtB,KAAM,CAAEJ,IAAI,CAAEK,KAAM,CAAC,CAAGD,CAAC,CAACE,MAAM,CAChC,KAAM,CAAAI,GAAG,CAAGpC,aAAa,CAAC0B,IAAI,CAAEK,KAAK,CAAC,CACtC,GAAIK,GAAG,CAAEnB,SAAS,CAACgB,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,MAAE,CAACP,IAAI,EAAGU,GAAG,EAAG,CAAC,CACxD,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAM,CAAAP,CAAC,EAAI,CAC9BA,CAAC,CAACQ,cAAc,CAAC,CAAC,CAClB,KAAM,CAAEC,OAAO,CAAEvB,MAAM,CAAEwB,SAAS,CAAEC,IAAK,CAAC,CAAG1C,oBAAoB,CAACa,QAAQ,CAAC,CAC3E,GAAI,CAAC2B,OAAO,CAAE,CACZtB,SAAS,CAACuB,SAAS,CAAC,CACpB,KAAM,CAAAE,KAAK,CAAGzC,gBAAgB,CAACuC,SAAS,CAAC,CACzC,GAAIE,KAAK,CAAEjB,UAAU,CAACiB,KAAK,CAAC,CAC5B,OACF,CAEA,GAAI,CACF,KAAM,CAAAhC,OAAO,CAAC+B,IAAI,CAAC,CACrB,CAAE,MAAOE,KAAK,CAAE,KAAAC,qBAAA,CACd;AACAzB,cAAc,CAACwB,KAAK,CAACE,OAAO,EAAI,uCAAuC,CAAC,CACxE,CAAAD,qBAAA,CAAAxB,WAAW,CAACG,OAAO,UAAAqB,qBAAA,iBAAnBA,qBAAA,CAAqBpB,KAAK,CAAC,CAAC,CAC9B,CACF,CAAC,CAED,mBACErB,IAAA,QAAK2C,SAAS,CAAC,sBAAsB,CAAAC,QAAA,cACnC1C,KAAA,SAAMyC,SAAS,CAAC,YAAY,CAACE,QAAQ,CAAEX,YAAa,CAAAU,QAAA,eAClD5C,IAAA,OAAI2C,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,0BAAS,CAAI,CAAC,CAEzC7B,WAAW,eACVf,IAAA,CAACL,YAAY,EACX+C,OAAO,CAAE3B,WAAY,CACrB+B,OAAO,CAAEA,CAAA,GAAM9B,cAAc,CAAC,EAAE,CAAE,CAClC+B,SAAS,CAAEA,CAAA,GAAM/B,cAAc,CAAC,EAAE,CAAE,CACrC,CACF,cAEDd,KAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5C,IAAA,UAAOgD,OAAO,CAAC,UAAU,CAACL,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,YAEjD,CAAO,CAAC,cACR5C,IAAA,UACEiD,GAAG,CAAEhC,WAAY,CACjBiC,IAAI,CAAC,MAAM,CACXC,EAAE,CAAC,UAAU,CACb5B,IAAI,CAAC,UAAU,CACfK,KAAK,CAAEnB,QAAQ,CAACE,QAAS,CACzByC,QAAQ,CAAE1B,iBAAkB,CAC5B2B,MAAM,CAAErB,UAAW,CACnBW,SAAS,eAAAW,MAAA,CACPzC,MAAM,CAACF,QAAQ,CAAG,mBAAmB,CAAG,EAAE,CACzC,CACH4C,WAAW,CAAC,sCAAuB,CACnCC,QAAQ,CAAEhD,SAAU,CACrB,CAAC,CACDK,MAAM,CAACF,QAAQ,eACdX,IAAA,SAAM2C,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAE/B,MAAM,CAACF,QAAQ,CAAO,CACrD,EACE,CAAC,cAENT,KAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB5C,IAAA,UAAOgD,OAAO,CAAC,UAAU,CAACL,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,YAEjD,CAAO,CAAC,cACR5C,IAAA,UACEiD,GAAG,CAAE/B,WAAY,CACjBgC,IAAI,CAAC,UAAU,CACfC,EAAE,CAAC,UAAU,CACb5B,IAAI,CAAC,UAAU,CACfK,KAAK,CAAEnB,QAAQ,CAACG,QAAS,CACzBwC,QAAQ,CAAE1B,iBAAkB,CAC5B2B,MAAM,CAAErB,UAAW,CACnBW,SAAS,eAAAW,MAAA,CACPzC,MAAM,CAACD,QAAQ,CAAG,mBAAmB,CAAG,EAAE,CACzC,CACH2C,WAAW,CAAC,sCAAuB,CACnCC,QAAQ,CAAEhD,SAAU,CACrB,CAAC,CACDK,MAAM,CAACD,QAAQ,eACdZ,IAAA,SAAM2C,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAE/B,MAAM,CAACD,QAAQ,CAAO,CACrD,EACE,CAAC,cAENZ,IAAA,WAAQkD,IAAI,CAAC,QAAQ,CAACP,SAAS,CAAC,YAAY,CAACa,QAAQ,CAAEhD,SAAU,CAAAoC,QAAA,CAC9DpC,SAAS,cACRN,KAAA,CAAAE,SAAA,EAAAwC,QAAA,eACE5C,IAAA,CAACN,cAAc,EAAC+D,IAAI,CAAC,OAAO,CAAE,CAAC,cAC/BzD,IAAA,SAAA4C,QAAA,CAAM,uCAAiB,CAAM,CAAC,EAC9B,CAAC,CAEH,WACD,CACK,CAAC,EACL,CAAC,CACJ,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}